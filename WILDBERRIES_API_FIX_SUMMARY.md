# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Wildberries API

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –∑–∞–∫–∞–∑–æ–≤ —Å Wildberries API –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
Error saving order: error: —Å—Ç–æ–ª–±–µ—Ü "order_id" –≤ —Ç–∞–±–ª–∏—Ü–µ "orders" –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–¥ –ø—ã—Ç–∞–ª—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–æ–ª–±–µ—Ü `order_id`, –Ω–æ –≤ —Ç–∞–±–ª–∏—Ü–µ `orders` –µ—Å—Ç—å —Å—Ç–æ–ª–±–µ—Ü `marketplace_order_id`.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –ò–∑–º–µ–Ω–µ–Ω SQL –∑–∞–ø—Ä–æ—Å —Å `order_id` –Ω–∞ `marketplace_order_id`
- –î–æ–±–∞–≤–ª–µ–Ω —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö Wildberries API
**–ü—Ä–æ–±–ª–µ–º–∞:** –î–∞–Ω–Ω—ã–µ —Å Wildberries API –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ –¥—Ä—É–≥–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, —á–µ–º –æ–∂–∏–¥–∞–ª–æ—Å—å.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```javascript
// –°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)
orderId: order.id?.toString() || order.orderId?.toString() || order.nmId?.toString()

// –ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)
orderId: order.gNumber || order.srid || order.nmId?.toString() || 'unknown'
```

### 3. –£–ª—É—á—à–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Order` –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —á–∞—Å—Ç–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ ID –∑–∞–∫–∞–∑–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö Wildberries

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö Wildberries

### –í—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ:
```javascript
{
  date: '2025-10-05T00:23:42',
  lastChangeDate: '2025-10-05T18:03:36',
  warehouseName: '–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä –ú–ü',
  supplierArticle: '143',
  nmId: 545387932,
  barcode: '2046310741040',
  category: '–†—É–∫–æ–¥–µ–ª–∏–µ',
  subject: '–ö–∞—Ä—Ç–∏–Ω—ã –ø–æ –Ω–æ–º–µ—Ä–∞–º',
  brand: '',
  totalPrice: 5000,
  discountPercent: 65,
  finishedPrice: 1311,
  priceWithDisc: 1750,
  isCancel: false,
  sticker: '42746474873',
  gNumber: '91607843428802460779',
  srid: '5950410890367963966.0.0',
  regionName: '–†–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
  oblastOkrugName: '–Æ–∂–Ω—ã–π —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –æ–∫—Ä—É–≥'
}
```

### –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
```javascript
{
  orderId: '91607843428802460779',        // gNumber
  totalAmount: 1311,                      // finishedPrice
  customerName: '–ö–ª–∏–µ–Ω—Ç Wildberries',     // –°—Ç–∞—Ç–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  customerPhone: '',                      // –ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ –≤ API
  customerEmail: '',                      // –ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ –≤ API
  deliveryAddress: '–†–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å, –Æ–∂–Ω—ã–π —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –æ–∫—Ä—É–≥',
  status: 'new',                          // 'cancelled' –µ—Å–ª–∏ isCancel = true
  marketplace: 'wildberries',
  items: [{
    article: '143',                       // supplierArticle
    name: '–ö–∞—Ä—Ç–∏–Ω—ã –ø–æ –Ω–æ–º–µ—Ä–∞–º',          // subject + brand
    quantity: 1,
    price: 1311,                          // finishedPrice
    totalPrice: 1311
  }]
}
```

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- **Wildberries API** - —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
- **–ò–º–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–æ–≤** - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –æ—à–∏–±–æ–∫
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç Wildberries

### üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
- **–ù–∞–π–¥–µ–Ω–æ –∑–∞–∫–∞–∑–æ–≤:** 14 –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
- **–£—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ:** 14 –∑–∞–∫–∞–∑–æ–≤
- **–û—à–∏–±–æ–∫:** 0 (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### SQL –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```sql
-- –î–æ–±–∞–≤–ª–µ–Ω —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å
CREATE UNIQUE INDEX idx_orders_client_marketplace_order 
ON orders (client_id, marketplace_order_id, marketplace);

-- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω INSERT –∑–∞–ø—Ä–æ—Å
INSERT INTO orders (client_id, marketplace_order_id, marketplace, ...)
VALUES ($1, $2, $3, ...)
ON CONFLICT (client_id, marketplace_order_id, marketplace) DO UPDATE SET ...
```

### –ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```javascript
// –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞
await client.query(
  `INSERT INTO orders (client_id, marketplace_order_id, marketplace, ...)`,
  [clientId, order.orderId, order.marketplace, ...]
);
```

---

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Wildberries API –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞!** üéâ

–¢–µ–ø–µ—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç:
- ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑—ã —Å Wildberries
- ‚úÖ –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –í–∏–¥–µ—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∫–∞–∂–¥–æ–º—É –∑–∞–∫–∞–∑—É
- ‚úÖ –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ –∏—Å–∫–∞—Ç—å –∑–∞–∫–∞–∑—ã




