# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫–∞–∑–æ–≤

## üêõ –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç** - Wildberries API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Unix timestamp, –Ω–æ –∫–æ–¥ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª –∫–∞–∫ ISO —Å—Ç—Ä–æ–∫–∏
2. **–í—Å–µ –∑–∞–∫–∞–∑—ã –ø–æ–º–µ—á–∞–ª–∏—Å—å –∫–∞–∫ "new"** - –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
3. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤** - –∑–∞–∫–∞–∑—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
4. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞—Ç** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ 'Z' –∫ —É–∂–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –¥–∞—Ç–∞–º

## ‚úÖ –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `fetchWildberriesOrders` –≤ `server/routes/client.js`

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç –∏–∑ Wildberries API
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–æ–≤
- –í—Å–µ –∑–∞–∫–∞–∑—ã –ø–æ–º–µ—á–∞–ª–∏—Å—å –∫–∞–∫ "new"

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```javascript
// –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç (Unix timestamp)
let orderDate;
if (order.date) {
  if (typeof order.date === 'number') {
    orderDate = new Date(order.date);
  } else {
    orderDate = new Date(order.date);
  }
} else {
  orderDate = new Date();
}

// –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
let status = 'new';
if (order.isCancel) {
  status = 'cancelled';
} else if (order.status) {
  const statusMap = {
    'new': 'new',
    'confirm': 'in_assembly',
    'cancel': 'cancelled',
    'delivered': 'delivered',
    'shipped': 'shipped'
  };
  status = statusMap[order.status] || 'new';
}
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞—Ç –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —á–∞—Å—Ç–∏

**–§–∞–π–ª—ã:** `client/app/client/orders/page.tsx`, `client/app/client/dashboard/page.tsx`

**–ë—ã–ª–æ:**
```javascript
{new Date(order.created_at + 'Z').toLocaleDateString('ru-RU')}
```

**–°—Ç–∞–ª–æ:**
```javascript
{new Date(order.created_at).toLocaleDateString('ru-RU')}
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–∏–æ–¥–æ–≤ –∏–º–ø–æ—Ä—Ç–∞

- **–°–µ–≥–æ–¥–Ω—è** - –∑–∞–∫–∞–∑—ã –∑–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å
- **7 –¥–Ω–µ–π** - –∑–∞–∫–∞–∑—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
- **–ú–µ—Å—è—Ü** - –∑–∞–∫–∞–∑—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π

### 4. –£–ª—É—á—à–µ–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –∑–∞–∫–∞–∑–æ–≤

```javascript
// –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∑–∞–∫–∞–∑–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö
let orderType = 'FBS'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é

if (order.isFBS !== undefined) {
  orderType = order.isFBS ? 'FBS' : 'DBW';
} else if (order.deliveryType) {
  switch (order.deliveryType) {
    case 'fbs': orderType = 'FBS'; break;
    case 'dbw': orderType = 'DBW'; break;
    case 'dbs': orderType = 'DBS'; break;
  }
}
```

## üßπ –°–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### `clean-orders.js`
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –£–¥–∞–ª—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –∑–∞–∫–∞–∑–æ–≤
2. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å—ã —Å—Ç–∞—Ä—ã—Ö –∑–∞–∫–∞–∑–æ–≤:
   - –°—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π ‚Üí 'delivered'
   - –°—Ç–∞—Ä—à–µ 3 –¥–Ω–µ–π ‚Üí 'shipped'
3. –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–∏–ø—ã –∑–∞–∫–∞–∑–æ–≤
4. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

### `clean-orders.bat`
–£–¥–æ–±–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –æ—á–∏—Å—Ç–∫–∏ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### 1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–Ω–æ)
```bash
./add-order-type-migration.bat
```

### 2. –û—á–∏—Å—Ç–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
```bash
./clean-orders.bat
```

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
```bash
# Docker
docker-compose restart

# –õ–æ–∫–∞–ª—å–Ω–æ
cd server && npm start
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–æ–≤
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–∫–∞–∑–æ–≤
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –∏–º–ø–æ—Ä—Ç–∞
3. –ù–∞–∂–º–∏—Ç–µ "–ò–º–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–æ–≤"
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∑–∞–∫–∞–∑—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞—Ç–∞–º–∏ –∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚úÖ –î–∞—Ç—ã –∑–∞–∫–∞–∑–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ –¢–∏–ø—ã –∑–∞–∫–∞–∑–æ–≤ (FBS, DBW, DBS) –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –°—Ç–∞—Ä—ã–µ –∑–∞–∫–∞–∑—ã –∏–º–µ—é—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∞—Ç—É—Å—ã

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞
```bash
# Docker
docker logs dropshipping-server

# –õ–æ–∫–∞–ª—å–Ω–æ
# –°–º–æ—Ç—Ä–∏—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ
```sql
SELECT 
  status,
  order_type,
  COUNT(*) as count,
  MIN(created_at) as oldest,
  MAX(created_at) as newest
FROM orders 
GROUP BY status, order_type
ORDER BY status, order_type;
```

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `server/routes/client.js` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫–∞–∑–æ–≤
- `client/app/client/orders/page.tsx` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞—Ç
- `client/app/client/dashboard/page.tsx` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞—Ç
- `clean-orders.js` - —Å–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- `clean-orders.bat` - bat-—Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ—á–∏—Å—Ç–∫–∏












