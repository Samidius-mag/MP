(()=>{var e={};e.id=313,e.ids=[313],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},5919:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>o,routeModule:()=>p,tree:()=>d});var s=r(482),a=r(9108),l=r(2563),i=r.n(l),n=r(8300),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);r.d(t,c);let d=["",{children:["client",{children:["products",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5598)),"/home/samidius/MP/client/app/client/products/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,4697))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,8762)),"/home/samidius/MP/client/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,4697))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["/home/samidius/MP/client/app/client/products/page.tsx"],x="/client/products/page",u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/client/products/page",pathname:"/client/products",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4066:(e,t,r)=>{Promise.resolve().then(r.bind(r,7488))},7488:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var s=r(5344),a=r(8779),l=r(3729),i=r(8117),n=r(4669),c=r(3759),d=r(5965);function o(){let[e,t]=(0,l.useState)([]),[r,a]=(0,l.useState)([]),[o,x]=(0,l.useState)(!1),[u,p]=(0,l.useState)(!1),[m,h]=(0,l.useState)(""),[g,y]=(0,l.useState)(null),[f,b]=(0,l.useState)("none"),[j,v]=(0,l.useState)("asc"),[N,w]=(0,l.useState)(10),[k,_]=(0,l.useState)(1),[C,S]=(0,l.useState)(null),[q,O]=(0,l.useState)(""),[E,P]=(0,l.useState)(null),[M,L]=(0,l.useState)(!1),[$,Z]=(0,l.useState)(null),[A,z]=(0,l.useState)(!1),[I,R]=(0,l.useState)([]),[G,W]=(0,l.useState)(""),[U,B]=(0,l.useState)([]),[F,D]=(0,l.useState)({}),[Y,T]=(0,l.useState)(""),[X,H]=(0,l.useState)(null),[J,K]=(0,l.useState)(!1),[Q,V]=(0,l.useState)(null),[ee,et]=(0,l.useState)(!1),[er,es]=(0,l.useState)([]),[ea,el]=(0,l.useState)(""),[ei,en]=(0,l.useState)([]),[ec,ed]=(0,l.useState)({}),[eo,ex]=(0,l.useState)("");(0,l.useEffect)(()=>{eu()},[]),(0,l.useEffect)(()=>{ep()},[e,m,g,f,j]);let eu=async()=>{try{x(!0);let e=(await i.h.get("/client/store-products")).data.products||[];t(e)}catch(e){console.error("Error fetching products:",e),n.default.error(e.response?.data?.error||"Ошибка загрузки товаров")}finally{x(!1)}},ep=()=>{let t=[...e];m&&(t=t.filter(e=>e.name.toLowerCase().includes(m.toLowerCase())||e.article.toLowerCase().includes(m.toLowerCase())||e.brand&&e.brand.toLowerCase().includes(m.toLowerCase()))),null!==g&&(t=t.filter(e=>e.is_active===g)),"none"!==f&&t.sort((e,t)=>{let r,s;switch(f){case"name":r=e.name||"",s=t.name||"";break;case"brand":r=e.brand||"",s=t.brand||"";break;case"price":r=Number(e.current_price)||0,s=Number(t.current_price)||0;break;default:return 0}return"string"==typeof r?"asc"===j?r.localeCompare(s):s.localeCompare(r):(isNaN(r)&&(r=0),isNaN(s)&&(s=0),"asc"===j?r-s:s-r)}),a(t),_(1)},em=async e=>{if(confirm("Вы уверены, что хотите удалить этот товар из магазина?"))try{await i.h.delete(`/client/store-products/${e}`),n.default.success("Товар удален из магазина"),await eu()}catch(e){console.error("Error deleting product:",e),n.default.error(e.response?.data?.error||"Ошибка удаления товара")}},eh=async()=>{if(confirm("Вы уверены, что хотите очистить весь магазин? Это действие нельзя отменить."))try{await i.h.delete("/client/store-products/clear"),n.default.success("Магазин очищен"),await eu()}catch(e){console.error("Error clearing store:",e),n.default.error(e.response?.data?.error||"Ошибка очистки магазина")}},eg=async()=>{try{p(!0);let e=await i.h.post("/client/store-products/load");n.default.success(e.data.message||`Загружено ${e.data.products?.length||0} товаров`),await eu()}catch(e){console.error("Error loading cards:",e),n.default.error(e.response?.data?.error||"Ошибка загрузки карточек")}finally{p(!1)}},ey=e=>e?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(e):"—",ef=e=>new Date(e).toLocaleDateString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),eb=async(e,t)=>{try{await i.h.put(`/client/store-products/${e}/markup`,{markup_percent:t}),n.default.success("Наценка обновлена"),await eu(),S(null),O("")}catch(e){console.error("Error updating markup:",e),n.default.error(e.response?.data?.error||"Ошибка обновления наценки")}},ej=async(t,r)=>{try{let s=e.find(e=>e.id===t);if(!s)return;let a=s.marketplace_targets||[],l=a.includes(r)?a.filter(e=>e!==r):[...a,r];await i.h.put(`/client/store-products/${t}/marketplaces`,{marketplace_targets:l}),n.default.success("Маркетплейсы обновлены"),await eu()}catch(e){console.error("Error updating marketplaces:",e),n.default.error(e.response?.data?.error||"Ошибка обновления маркетплейсов")}},ev=async e=>{Z(e),L(!0),ek()},eN=(e,t)=>e?e*(1+(t||0)/100):null,ew=async e=>{if(B([]),D({}),e){z(!0);try{let{data:t}=await i.h.post(`/client/yandex/category/${e}/parameters`),r=t?.parameters||t?.result||[];B(Array.isArray(r)?r:[])}catch(e){n.default.error(e.response?.data?.error||"Ошибка загрузки параметров категории")}finally{z(!1)}}},ek=async()=>{z(!0);try{let{data:e}=await i.h.get("/client/yandex/categories"),t=e?.categories||e?.result||e;R(Array.isArray(t)?t:[])}catch(e){console.error("YM categories error:",e),n.default.error(e.response?.data?.error||"Ошибка загрузки категорий Яндекс.Маркет")}finally{z(!1)}};(0,l.useEffect)(()=>{M&&ek()},[M]);let e_=async e=>{V(e),K(!0),eC()},eC=async()=>{et(!0);try{let{data:e}=await i.h.get("/client/ozon/categories"),t=e?.categories||e?.result||e;es(Array.isArray(t)?t:[])}catch(e){console.error("OZON categories error:",e),n.default.error(e.response?.data?.error||"Ошибка загрузки категорий OZON")}finally{et(!1)}},eS=async e=>{if(en([]),ed({}),e){et(!0);try{let{data:t}=await i.h.post(`/client/ozon/category/${e}/attributes`),r=t?.attributes||t?.result||[];en(Array.isArray(r)?r:[])}catch(e){n.default.error(e.response?.data?.error||"Ошибка загрузки атрибутов категории")}finally{et(!1)}}},eq=async()=>{if(Q){if(!ea){n.default.error("Выберите категорию OZON");return}H(Q);try{let e=Object.entries(ec).filter(([e,t])=>null!=t&&""!==String(t).trim()).map(([e,t])=>({id:Number(e),value:String(t)}));await i.h.post(`/client/store-products/${Q}/upload/ozon`,{categoryId:Number(ea),attributes:e.length>0?e:void 0}),n.default.success("Товар загружен на OZON"),K(!1),V(null),await eu()}catch(e){console.error("Error uploading to OZON:",e),n.default.error(e.response?.data?.error||"Ошибка загрузки на OZON")}finally{H(null)}}};(0,l.useEffect)(()=>{J&&eC()},[J]);let eO=async()=>{if($){if(!G){n.default.error("Выберите категорию Яндекс.Маркет");return}P($);try{let e=Object.entries(F).filter(([e,t])=>null!=t&&""!==String(t).trim()).map(([e,t])=>({paramId:Number(e),value:t}));await i.h.post(`/client/store-products/${$}/upload/yandex-market`,{marketCategoryId:Number(G),parameterValues:e}),n.default.success("Товар загружен на Яндекс Маркет"),L(!1),Z(null),await eu()}catch(e){console.error("Error uploading to Yandex Market:",e),n.default.error(e.response?.data?.error||"Ошибка загрузки на Яндекс Маркет")}finally{P(null)}}};return o?s.jsx("div",{className:"space-y-6",children:(0,s.jsxs)("div",{className:"animate-pulse space-y-4",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),s.jsx("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>s.jsx("div",{className:"h-24 bg-gray-200 rounded"},t))})]})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Товары магазина"}),s.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Просмотр и управление товарами из разных источников (Wildberries, Сима Ленд)"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:eg,disabled:u,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:[s.jsx(c.Z,{className:"w-4 h-4 mr-2"}),u?"Загрузка...":"Загрузить карточки"]}),e.length>0&&s.jsx("button",{onClick:eh,className:"inline-flex items-center px-4 py-2 border border-red-300 text-sm font-medium rounded-md shadow-sm text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Очистить магазин"})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(d.Z,{className:"h-5 w-5 text-gray-400"})}),s.jsx("input",{type:"text",placeholder:"Поиск по названию, артикулу...",value:m,onChange:e=>h(e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})]}),(0,s.jsxs)("select",{value:null===g?"all":g?"active":"inactive",onChange:e=>{let t=e.target.value;y("all"===t?null:"active"===t)},className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"Все"}),s.jsx("option",{value:"active",children:"Активные"}),s.jsx("option",{value:"inactive",children:"Неактивные"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm text-gray-700",children:"Сортировка:"}),(0,s.jsxs)("select",{value:f,onChange:e=>b(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"none",children:"Без сортировки"}),s.jsx("option",{value:"name",children:"По названию"}),s.jsx("option",{value:"brand",children:"По бренду"}),s.jsx("option",{value:"price",children:"По цене"})]}),"none"!==f&&s.jsx("button",{onClick:()=>v("asc"===j?"desc":"asc"),className:"px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50 text-sm",title:"asc"===j?"По возрастанию":"По убыванию",children:"asc"===j?"↑":"↓"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[s.jsx("span",{className:"text-sm text-gray-700",children:"Товаров на странице:"}),(0,s.jsxs)("select",{value:N,onChange:e=>{w(Number(e.target.value)),_(1)},className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"10",children:"10"}),s.jsx("option",{value:"25",children:"25"}),s.jsx("option",{value:"50",children:"50"}),s.jsx("option",{value:"100",children:"100"})]})]})]})]}),0===r.length?s.jsx("div",{className:"card text-center",children:s.jsx("div",{className:"py-12",children:s.jsx("p",{className:"text-gray-500",children:'Товары не найдены. Нажмите "Загрузить карточки" для импорта товаров из Wildberries.'})})}):(0,s.jsxs)("div",{className:"card",children:[s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 table-fixed",children:[s.jsx("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-2 py-2 text-left text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Товар"}),s.jsx("th",{className:"px-2 py-2 text-left text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Артикул / nmId"}),s.jsx("th",{className:"px-2 py-2 text-left text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Цена"}),s.jsx("th",{className:"px-2 py-2 text-left text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Комиссия"}),s.jsx("th",{className:"px-2 py-2 text-left text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Логистика"}),s.jsx("th",{className:"px-2 py-2 text-left text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Статус"}),s.jsx("th",{className:"px-2 py-2 text-left text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Закупка / Наценка"}),s.jsx("th",{className:"px-2 py-2 text-left text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Остаток"}),s.jsx("th",{className:"px-2 py-2 text-left text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Маркетплейсы"}),s.jsx("th",{className:"px-2 py-2 text-left text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Обновлено"}),s.jsx("th",{className:"px-2 py-2 text-left text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.slice((k-1)*N,k*N).map(e=>{let t=eN(e.purchase_price,e.markup_percent),r=e.marketplace_targets||[];return(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-2 py-2 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("div",{className:"text-xs font-medium text-gray-900",children:e.name}),e.brand&&s.jsx("div",{className:"text-[11px] text-gray-500",children:e.brand}),e.category&&s.jsx("div",{className:"text-[10px] text-gray-400",children:e.category}),e.source&&s.jsx("div",{className:"text-[10px] text-blue-600 mt-1",children:"sima_land"===e.source?"Сима Ленд":"Wildberries"})]})}),(0,s.jsxs)("td",{className:"px-2 py-2 whitespace-nowrap",children:[s.jsx("div",{className:"text-xs text-gray-900",children:e.article}),e.nm_id&&(0,s.jsxs)("div",{className:"text-[10px] text-gray-500",children:["nmId: ",e.nm_id]})]}),s.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-xs text-gray-900",children:ey(e.current_price||t||void 0)}),s.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-xs text-gray-500",children:e.commission_percent?`${e.commission_percent}%`:"—"}),s.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-xs text-gray-500",children:ey(e.logistics_cost)}),(0,s.jsxs)("td",{className:"px-2 py-2 whitespace-nowrap",children:[s.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-medium ${e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.is_active?"Активен":"Неактивен"}),e.in_promotion&&(0,s.jsxs)("div",{className:"text-[10px] text-purple-600 mt-1",children:["В акции: ",e.promotion_discount_percent,"%"]})]}),s.jsx("td",{className:"px-2 py-2 whitespace-nowrap",children:s.jsx("div",{className:"text-xs",children:e.purchase_price?(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"text-gray-900 text-xs",children:ey(e.purchase_price)}),C===e.id?(0,s.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[s.jsx("input",{type:"number",value:q,onChange:e=>O(e.target.value),placeholder:e.markup_percent?.toString()||"0",className:"w-14 px-2 py-1 text-[11px] border border-gray-300 rounded",autoFocus:!0}),s.jsx("span",{className:"text-[11px] text-gray-500",children:"%"}),s.jsx("button",{onClick:()=>{let t=parseFloat(q);!isNaN(t)&&t>=0&&eb(e.id,t)},className:"px-2 py-1 text-[11px] bg-green-600 text-white rounded hover:bg-green-700",children:"✓"}),s.jsx("button",{onClick:()=>{S(null),O("")},className:"px-2 py-1 text-[11px] bg-gray-400 text-white rounded hover:bg-gray-500",children:"\xd7"})]}):(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,s.jsxs)("span",{className:"text-[11px] text-gray-600",children:["Наценка: ",e.markup_percent||0,"%"]}),s.jsx("button",{onClick:()=>{S(e.id),O(e.markup_percent?.toString()||"")},className:"text-[11px] text-blue-600 hover:text-blue-800",children:"Изменить"})]}),t&&(0,s.jsxs)("div",{className:"text-[11px] text-green-600 mt-1",children:["Продажа: ",ey(t)]})]}):s.jsx("span",{className:"text-gray-400 text-xs",children:"—"})})}),s.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-xs text-gray-900",children:void 0!==e.available_quantity?e.available_quantity:"—"}),s.jsx("td",{className:"px-2 py-2 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[["wb","ozon","yandex_market"].map(t=>{let a=r.includes(t);return s.jsx("button",{onClick:()=>ej(e.id,t),className:`px-2 py-1 text-[11px] rounded ${a?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:{wb:"WB",ozon:"Ozon",yandex_market:"ЯМ"}[t]},t)}),"sima_land"===e.source&&r.includes("yandex_market")&&s.jsx("button",{onClick:()=>ev(e.id),disabled:E===e.id,className:"mt-1 px-2 py-1 text-[11px] bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:E===e.id?"Загрузка...":"Загрузить на ЯМ"}),r.includes("ozon")&&s.jsx("button",{onClick:()=>e_(e.id),disabled:X===e.id,className:"mt-1 px-2 py-1 text-[11px] bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:X===e.id?"Загрузка...":"Загрузить на OZON"})]})}),s.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-[11px] text-gray-500",children:ef(e.last_updated)}),s.jsx("td",{className:"px-2 py-2 whitespace-nowrap",children:s.jsx("button",{onClick:()=>em(e.id),className:"px-3 py-1 text-xs font-medium text-red-700 bg-red-50 border border-red-200 rounded-md hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Удалить"})})]},e.id)})})]})}),Math.ceil(r.length/N)>1&&(0,s.jsxs)("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-700",children:["Показано ",(k-1)*N+1," - ",Math.min(k*N,r.length)," из ",r.length]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>_(Math.max(1,k-1)),disabled:1===k,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Назад"}),s.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,Math.ceil(r.length/N))},(e,t)=>{let a;let l=Math.ceil(r.length/N);return a=l<=5?t+1:k<=3?t+1:k>=l-2?l-4+t:k-2+t,s.jsx("button",{onClick:()=>_(a),className:`px-3 py-1 text-sm font-medium rounded-md ${k===a?"bg-blue-600 text-white":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:a},a)})}),s.jsx("button",{onClick:()=>_(Math.min(Math.ceil(r.length/N),k+1)),disabled:k>=Math.ceil(r.length/N),className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Вперед"})]})]})]}),r.length>0&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Всего товаров"}),s.jsx("div",{className:"text-2xl font-bold text-blue-900",children:r.length})]}),(0,s.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Активных"}),s.jsx("div",{className:"text-2xl font-bold text-green-900",children:r.filter(e=>e.is_active).length})]}),(0,s.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"В акциях"}),s.jsx("div",{className:"text-2xl font-bold text-purple-900",children:r.filter(e=>e.in_promotion).length})]}),(0,s.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"Средняя цена"}),s.jsx("div",{className:"text-2xl font-bold text-orange-900",children:ey(r.reduce((e,t)=>e+(t.current_price||0),0)/r.length)})]})]}),M&&s.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Загрузка на Яндекс.Маркет"}),s.jsx("button",{onClick:()=>L(!1),className:"text-gray-500 hover:text-gray-700",children:"\xd7"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"label",children:"Категория Яндекс.Маркет"}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx("input",{type:"text",className:"input",placeholder:"Поиск категории...",value:Y,onChange:e=>T(e.target.value)}),(0,s.jsxs)("select",{value:G,onChange:e=>{W(e.target.value),ew(e.target.value)},className:"input",size:8,children:[s.jsx("option",{value:"",children:"Выберите категорию"}),I.filter(e=>{if(!Y)return!0;let t=Y.toLowerCase();return String(e.name||e.title||e.id).toLowerCase().includes(t)}).slice(0,200).map(e=>s.jsx("option",{value:e.id,children:e.name||e.title||e.id},e.id))]}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:["Найдено: ",I.filter(e=>{if(!Y)return!0;let t=Y.toLowerCase();return String(e.name||e.title||e.id).toLowerCase().includes(t)}).length," (показано до 200)"]})]})]}),A&&s.jsx("div",{className:"text-sm text-gray-500",children:"Загрузка..."}),!A&&U&&U.length>0&&(0,s.jsxs)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:[s.jsx("div",{className:"text-sm text-gray-700",children:"Характеристики категории (заполните обязательные):"}),U.map(e=>(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 items-center",children:[(0,s.jsxs)("div",{className:"text-sm",children:[s.jsx("span",{className:"font-medium",children:e.name||e.title||`Параметр ${e.id}`}),e.required&&s.jsx("span",{className:"ml-1 text-red-600",children:"*"})]}),s.jsx("div",{className:"md:col-span-2",children:s.jsx("input",{type:"text",className:"input",placeholder:e.unit?.defaultUnitId?`Ед.: ${e.unit?.defaultUnitId}`:"",value:F[e.id]?.value||F[e.id]||"",onChange:t=>{let r=t.target.value;D(t=>({...t,[e.id]:r}))}})})]},e.id))]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[s.jsx("button",{onClick:()=>L(!1),className:"btn-secondary",children:"Отмена"}),s.jsx("button",{onClick:eO,className:"btn-primary",disabled:null!==E,children:E?"Загрузка...":"Загрузить"})]})]})]})}),J&&s.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Загрузка на OZON"}),s.jsx("button",{onClick:()=>K(!1),className:"text-gray-500 hover:text-gray-700",children:"\xd7"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"label",children:"Категория OZON"}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx("input",{type:"text",className:"input",placeholder:"Поиск категории...",value:eo,onChange:e=>ex(e.target.value)}),(0,s.jsxs)("select",{value:ea,onChange:e=>{el(e.target.value),eS(e.target.value)},className:"input",size:8,children:[s.jsx("option",{value:"",children:"Выберите категорию"}),er.filter(e=>{if(!eo)return!0;let t=eo.toLowerCase();return String(e.name||e.title||e.id).toLowerCase().includes(t)}).slice(0,200).map(e=>s.jsx("option",{value:e.id,children:e.name||e.title||e.id},e.id))]}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:["Найдено: ",er.filter(e=>{if(!eo)return!0;let t=eo.toLowerCase();return String(e.name||e.title||e.id).toLowerCase().includes(t)}).length," (показано до 200)"]})]})]}),ee&&s.jsx("div",{className:"text-sm text-gray-500",children:"Загрузка..."}),!ee&&ei&&ei.length>0&&(0,s.jsxs)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:[s.jsx("div",{className:"text-sm text-gray-700",children:"Атрибуты категории (заполните обязательные):"}),ei.map(e=>(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 items-center",children:[(0,s.jsxs)("div",{className:"text-sm",children:[s.jsx("span",{className:"font-medium",children:e.name||e.title||`Атрибут ${e.id}`}),e.is_required&&s.jsx("span",{className:"ml-1 text-red-600",children:"*"})]}),s.jsx("div",{className:"md:col-span-2",children:s.jsx("input",{type:"text",className:"input",placeholder:e.type||"",value:ec[e.id]?.value||ec[e.id]||"",onChange:t=>{let r=t.target.value;ed(t=>({...t,[e.id]:r}))}})})]},e.id))]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[s.jsx("button",{onClick:()=>K(!1),className:"btn-secondary",children:"Отмена"}),s.jsx("button",{onClick:eq,className:"btn-primary",disabled:null!==X,children:X?"Загрузка...":"Загрузить"})]})]})]})})]})}function x(){return s.jsx(a.Z,{requiredRole:"client",children:s.jsx(o,{})})}},5598:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>l,__esModule:()=>a,default:()=>i});let s=(0,r(6843).createProxy)(String.raw`/home/samidius/MP/client/app/client/products/page.tsx`),{__esModule:a,$$typeof:l}=s,i=s.default},5965:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(3729);let a=s.forwardRef(function({title:e,titleId:t,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))})},3759:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(3729);let a=s.forwardRef(function({title:e,titleId:t,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[456,472,898,783,838],()=>r(5919));module.exports=s})();