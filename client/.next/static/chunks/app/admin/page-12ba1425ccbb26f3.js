(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{8865:function(e,t,s){Promise.resolve().then(s.bind(s,1254))},1254:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var a=s(7437),r=s(2265),l=s(9438),i=s(4033),n=s(826);function d(){let[e,t]=(0,r.useState)(null),[s,l]=(0,r.useState)(null),[i,d]=(0,r.useState)(!0),[o,c]=(0,r.useState)(null);(0,r.useEffect)(()=>{m()},[]);let m=async()=>{try{d(!0);let[e,s]=await Promise.all([n.h.get("/admin/stats"),n.h.get("/admin/logs/stats")]);t(e.data),l(s.data)}catch(t){var e,s;c((null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.error)||"Ошибка загрузки данных")}finally{d(!1)}};return i?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"h-24 bg-gray-200 rounded"},t))})]})}):o?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsx)("div",{className:"flex",children:(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Ошибка загрузки"}),(0,a.jsx)("div",{className:"mt-2 text-sm text-red-700",children:o})]})})})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Обзор системы"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Статистика и ключевые показатели"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-medium",children:"\uD83D\uDC65"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"Всего пользователей"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:(null==e?void 0:e.overview.totalUsers)||0})]})]})}),(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-green-500 rounded-md flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-medium",children:"\uD83C\uDFE2"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Клиентов"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-900",children:(null==e?void 0:e.overview.totalClients)||0})]})]})}),(0,a.jsx)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-medium",children:"\uD83D\uDCE6"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-purple-600",children:"Заказов"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-purple-900",children:(null==e?void 0:e.overview.totalOrders)||0})]})]})}),(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-yellow-500 rounded-md flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-medium",children:"\uD83D\uDCB0"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-yellow-600",children:"Комиссия (1.5%)"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:(null==e?void 0:e.overview.totalRevenue)?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(e.overview.totalRevenue):"₽0"})]})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Пользователи по ролям"}),(0,a.jsx)("div",{className:"space-y-3",children:(null==e?void 0:e.usersByRole)&&Object.entries(e.usersByRole).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-600 capitalize",children:"client"===t?"Клиенты":"operator"===t?"Операторы":"Администраторы"}),(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900",children:s})]},t)})})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Заказы по статусам"}),(0,a.jsx)("div",{className:"space-y-3",children:(null==e?void 0:e.ordersByStatus)&&Object.entries(e.ordersByStatus).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-600 capitalize",children:"new"===t?"Новые":"in_assembly"===t?"В сборке":"ready_to_ship"===t?"Готов к отправке":"shipped"===t?"Отправлен":"delivered"===t?"Доставлен":"cancelled"===t?"Отменен":t}),(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900",children:s})]},t)})})]})]}),s&&(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Статистика логов (24 часа)"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Логи сервера"}),(0,a.jsx)("div",{className:"space-y-2",children:s.serverLogs.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium px-2 py-1 rounded ".concat("error"===e.level?"bg-red-100 text-red-800":"warn"===e.level?"bg-yellow-100 text-yellow-800":"info"===e.level?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.level.toUpperCase()}),(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900",children:e.count})]},e.level))})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Логи клиента"}),(0,a.jsx)("div",{className:"space-y-2",children:s.clientLogs.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium px-2 py-1 rounded ".concat("error"===e.level?"bg-red-100 text-red-800":"warn"===e.level?"bg-yellow-100 text-yellow-800":"info"===e.level?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.level.toUpperCase()}),(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900",children:e.count})]},e.level))})]})]})]})]})}var o=s(5925);function c(){let[e,t]=(0,r.useState)([]),[s,l]=(0,r.useState)(null),[i,d]=(0,r.useState)(null),[c,m]=(0,r.useState)(!0),[u,x]=(0,r.useState)(!1),[h,g]=(0,r.useState)(!1),[p,b]=(0,r.useState)(""),[f,v]=(0,r.useState)(""),[y,j]=(0,r.useState)(""),[N,w]=(0,r.useState)(""),[k,C]=(0,r.useState)(1),[E,S]=(0,r.useState)(1),[D,_]=(0,r.useState)(!1),[I,A]=(0,r.useState)(!1),[O,L]=(0,r.useState)({firstName:"",lastName:""}),[z,P]=(0,r.useState)(null),[R,U]=(0,r.useState)(!1),[B,$]=(0,r.useState)(!1),[T,F]=(0,r.useState)(null);(0,r.useEffect)(()=>{M()},[k,y,N]);let M=async()=>{try{m(!0);let e=new URLSearchParams({page:k.toString(),limit:"20"});y&&e.append("search",y),N&&e.append("role",N);let s=await n.h.get("/admin/users?".concat(e));t(s.data.users),S(s.data.pagination.totalPages)}catch(t){var e,s;o.default.error((null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.error)||"Ошибка загрузки пользователей")}finally{m(!1)}},q=async e=>{try{let t=await n.h.get("/admin/users/".concat(e));l(t.data.user),d(t.data.stats)}catch(e){var t,s;o.default.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Ошибка загрузки данных пользователя")}},J=async(e,t)=>{try{x(!0),await n.h.put("/admin/users/".concat(e,"/status"),{isActive:t}),o.default.success("Пользователь ".concat(t?"активирован":"заблокирован")),M(),(null==s?void 0:s.id)===e&&l(e=>e?{...e,is_active:t}:null)}catch(e){var a,r;o.default.error((null===(r=e.response)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.error)||"Ошибка изменения статуса")}finally{x(!1)}},H=async()=>{if(!O.firstName||!O.lastName){o.default.error("Заполните все обязательные поля");return}A(!0);try{let e=await n.h.post("/admin/users/operator",O);P(e.data.credentials),o.default.success("Оператор успешно создан"),L({firstName:"",lastName:""}),await M()}catch(s){var e,t;o.default.error((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"Ошибка создания оператора")}finally{A(!1)}},W=e=>{F(e),U(!0)},Z=async()=>{if(T){$(!0);try{await n.h.delete("/admin/users/".concat(T.id)),o.default.success("Пользователь ".concat(T.first_name," ").concat(T.last_name," успешно удален")),U(!1),F(null),(null==s?void 0:s.id)===T.id&&(l(null),d(null)),await M()}catch(s){var e,t;o.default.error((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"Ошибка удаления пользователя")}finally{$(!1)}}},G=async()=>{if(p!==f){o.default.error("Пароли не совпадают");return}if(p.length<8){o.default.error("Пароль должен содержать минимум 8 символов");return}try{x(!0),await n.h.put("/admin/users/".concat(null==s?void 0:s.id,"/password"),{newPassword:p,confirmPassword:f}),o.default.success("Пароль успешно изменен"),g(!1),b(""),v("")}catch(s){var e,t;o.default.error((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"Ошибка смены пароля")}finally{x(!1)}},V=e=>{switch(e){case"client":return"Клиент";case"operator":return"Оператор";case"admin":return"Администратор";default:return e}},Y=e=>(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e?"Активен":"Заблокирован"});return c?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,a.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"h-16 bg-gray-200 rounded"},t))})]})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Управление пользователями"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Просмотр и управление пользователями системы"})]}),(0,a.jsx)("button",{onClick:()=>_(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"+ Создать оператора"})]})}),(0,a.jsxs)("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("input",{type:"text",placeholder:"Поиск по email, имени или компании...",value:y,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,a.jsxs)("select",{value:N,onChange:e=>w(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Все роли"}),(0,a.jsx)("option",{value:"client",children:"Клиенты"}),(0,a.jsx)("option",{value:"operator",children:"Операторы"}),(0,a.jsx)("option",{value:"admin",children:"Администраторы"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Список пользователей"})}),(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:e.map(e=>(0,a.jsx)("div",{className:"p-4 hover:bg-gray-50 cursor-pointer ".concat((null==s?void 0:s.id)===e.id?"bg-blue-50":""),onClick:()=>q(e.id),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("div",{className:"flex items-center space-x-3",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.email}),e.company_name&&(0,a.jsx)("p",{className:"text-xs text-gray-400",children:e.company_name})]})})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:V(e.role)}),Y(e.is_active)]})]})},e.id))}),E>1&&(0,a.jsxs)("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200 flex justify-between items-center",children:[(0,a.jsx)("button",{onClick:()=>C(k-1),disabled:1===k,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Назад"}),(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Страница ",k," из ",E]}),(0,a.jsx)("button",{onClick:()=>C(k+1),disabled:k===E,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Вперед"})]})]})}),(0,a.jsx)("div",{className:"lg:col-span-1",children:s?(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Детали пользователя"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Имя"}),(0,a.jsxs)("p",{className:"text-sm text-gray-900",children:[s.first_name," ",s.last_name]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:s.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Телефон"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:s.phone})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Роль"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:V(s.role)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Статус"}),(0,a.jsx)("div",{className:"mt-1",children:Y(s.is_active)})]}),s.company_name&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Компания"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:s.company_name})]}),s.inn&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"ИНН"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:s.inn})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Дата регистрации"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:new Date(s.created_at).toLocaleDateString("ru-RU")})]}),"client"===s.role&&i&&(0,a.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Статистика"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Заказов:"}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-900",children:i.totalOrders})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Сумма заказов:"}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-900",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(i.totalAmount)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Баланс:"}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-900",children:new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(i.currentBalance)})]})]})]}),(0,a.jsxs)("div",{className:"pt-4 border-t border-gray-200 space-y-2",children:[(0,a.jsx)("button",{onClick:()=>J(s.id,!s.is_active),disabled:u,className:"w-full px-3 py-2 text-sm font-medium rounded-md ".concat(s.is_active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"," disabled:opacity-50"),children:s.is_active?"Заблокировать":"Активировать"}),(0,a.jsx)("button",{onClick:()=>g(!0),className:"w-full px-3 py-2 text-sm font-medium text-blue-700 bg-blue-100 rounded-md hover:bg-blue-200",children:"Сменить пароль"}),"admin"!==s.role&&(0,a.jsx)("button",{onClick:()=>W(s),className:"w-full px-3 py-2 text-sm font-medium text-red-700 bg-red-100 rounded-md hover:bg-red-200",children:"Удалить пользователя"})]})]})]}):(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 text-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Выберите пользователя для просмотра деталей"})})})]}),h&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Смена пароля"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Новый пароль"}),(0,a.jsx)("input",{type:"password",value:p,onChange:e=>b(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Минимум 8 символов"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Подтверждение пароля"}),(0,a.jsx)("input",{type:"password",value:f,onChange:e=>v(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Повторите пароль"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{onClick:()=>{g(!1),b(""),v("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Отмена"}),(0,a.jsx)("button",{onClick:G,disabled:u||!p||!f,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50",children:u?"Сохранение...":"Сохранить"})]})]})})}),D&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Создание оператора"}),z?(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-green-800 mb-2",children:"Оператор создан успешно!"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Логин:"}),(0,a.jsx)("div",{className:"mt-1 p-2 bg-gray-100 rounded font-mono text-sm",children:z.login})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Пароль:"}),(0,a.jsx)("div",{className:"mt-1 p-2 bg-gray-100 rounded font-mono text-sm",children:z.password})]})]}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mt-2",children:"Сохраните эти данные! Они больше не будут показаны."})]})}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Имя *"}),(0,a.jsx)("input",{type:"text",value:O.firstName,onChange:e=>L(t=>({...t,firstName:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Иван"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Фамилия *"}),(0,a.jsx)("input",{type:"text",value:O.lastName,onChange:e=>L(t=>({...t,lastName:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Иванов"})]})]}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:(0,a.jsx)("p",{className:"text-sm text-blue-800",children:"Система автоматически сгенерирует логин и пароль для оператора."})})]}),(0,a.jsx)("div",{className:"flex justify-end space-x-3 mt-6",children:z?(0,a.jsx)("button",{onClick:()=>{_(!1),P(null),L({firstName:"",lastName:""})},className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",children:"Закрыть"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>{_(!1),L({firstName:"",lastName:""})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Отмена"}),(0,a.jsx)("button",{onClick:H,disabled:I,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50",children:I?"Создание...":"Создать оператора"})]})})]})})}),R&&T&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:(0,a.jsx)("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 text-center mb-2",children:"Подтверждение удаления"}),(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"Вы уверены, что хотите удалить пользователя?"}),(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded-md",children:[(0,a.jsxs)("p",{className:"font-medium text-gray-900",children:[T.first_name," ",T.last_name]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:T.email}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:V(T.role)})]}),(0,a.jsx)("p",{className:"text-xs text-red-600 mt-2",children:"⚠️ Это действие нельзя отменить"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{onClick:()=>{U(!1),F(null)},disabled:B,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 disabled:opacity-50",children:"Отмена"}),(0,a.jsx)("button",{onClick:Z,disabled:B,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 disabled:opacity-50",children:B?"Удаление...":"Удалить"})]})]})})})]})}function m(){let[e,t]=(0,r.useState)([]),[s,l]=(0,r.useState)({page:1,limit:50,total:0,totalPages:0,hasNext:!1,hasPrev:!1}),[i,d]=(0,r.useState)(!0),[o,c]=(0,r.useState)("server"),[m,u]=(0,r.useState)({level:"",service:"",userId:"",component:"",action:"",startDate:"",endDate:""}),[x,h]=(0,r.useState)(null);(0,r.useEffect)(()=>{g()},[o,s.page,m]);let g=async()=>{try{d(!0);let e=new URLSearchParams({page:s.page.toString(),limit:s.limit.toString()});Object.entries(m).forEach(t=>{let[s,a]=t;a&&e.append(s,a)});let a=(await n.h.get("/admin/logs/".concat(o,"?").concat(e))).data;t(a.logs),l(a.pagination)}catch(e){console.error("Error fetching logs:",e)}finally{d(!1)}},p=e=>{let t={error:"bg-red-100 text-red-800",warn:"bg-yellow-100 text-yellow-800",info:"bg-blue-100 text-blue-800",debug:"bg-gray-100 text-gray-800"};return(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(t[e]||t.debug),children:e.toUpperCase()})},b=e=>new Date(e).toLocaleString("ru-RU"),f=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return e.length>t?e.substring(0,t)+"...":e},v=(e,t)=>{u(s=>({...s,[e]:t})),l(e=>({...e,page:1}))};return i?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,a.jsx)("div",{className:"space-y-3",children:[...Array(10)].map((e,t)=>(0,a.jsx)("div",{className:"h-16 bg-gray-200 rounded"},t))})]})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Просмотр логов"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Мониторинг активности системы и пользователей"})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,a.jsx)("button",{onClick:()=>c("server"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("server"===o?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Логи сервера"}),(0,a.jsx)("button",{onClick:()=>c("client"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("client"===o?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Логи клиента"})]})})}),(0,a.jsx)("div",{className:"mb-6 bg-gray-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Уровень"}),(0,a.jsxs)("select",{value:m.level,onChange:e=>v("level",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Все уровни"}),(0,a.jsx)("option",{value:"error",children:"Error"}),(0,a.jsx)("option",{value:"warn",children:"Warning"}),(0,a.jsx)("option",{value:"info",children:"Info"}),(0,a.jsx)("option",{value:"debug",children:"Debug"})]})]}),"server"===o&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Сервис"}),(0,a.jsx)("input",{type:"text",value:m.service,onChange:e=>v("service",e.target.value),placeholder:"auth, orders, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),"client"===o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Компонент"}),(0,a.jsx)("input",{type:"text",value:m.component,onChange:e=>v("component",e.target.value),placeholder:"Component name",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Действие"}),(0,a.jsx)("input",{type:"text",value:m.action,onChange:e=>v("action",e.target.value),placeholder:"User action",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ID пользователя"}),(0,a.jsx)("input",{type:"number",value:m.userId,onChange:e=>v("userId",e.target.value),placeholder:"User ID",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Дата с"}),(0,a.jsx)("input",{type:"datetime-local",value:m.startDate,onChange:e=>v("startDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Дата по"}),(0,a.jsx)("input",{type:"datetime-local",value:m.endDate,onChange:e=>v("endDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)("button",{onClick:()=>{u({level:"",service:"",userId:"",component:"",action:"",startDate:"",endDate:""}),l(e=>({...e,page:1}))},className:"w-full px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Очистить"})})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Логи ","server"===o?"сервера":"клиента","(",s.total," записей)"]})}),(0,a.jsx)("div",{className:"divide-y divide-gray-200 max-h-96 overflow-y-auto",children:e.map(e=>(0,a.jsx)("div",{className:"p-4 hover:bg-gray-50 cursor-pointer ".concat((null==x?void 0:x.id)===e.id?"bg-blue-50":""),onClick:()=>h(e),children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[p(e.level),e.service&&(0,a.jsx)("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:e.service}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:b(e.created_at)})]}),(0,a.jsx)("p",{className:"text-sm text-gray-900 mb-1",children:f(e.message)}),e.email&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Пользователь: ",e.email," (",e.first_name," ",e.last_name,")"]})]})})},e.id))}),s.totalPages>1&&(0,a.jsxs)("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200 flex justify-between items-center",children:[(0,a.jsx)("button",{onClick:()=>l(e=>({...e,page:e.page-1})),disabled:!s.hasPrev,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Назад"}),(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Страница ",s.page," из ",s.totalPages]}),(0,a.jsx)("button",{onClick:()=>l(e=>({...e,page:e.page+1})),disabled:!s.hasNext,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Вперед"})]})]})}),(0,a.jsx)("div",{className:"lg:col-span-1",children:x?(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Детали лога"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Уровень"}),(0,a.jsx)("div",{className:"mt-1",children:p(x.level)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Сообщение"}),(0,a.jsx)("p",{className:"text-sm text-gray-900 mt-1 break-words",children:x.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Время"}),(0,a.jsx)("p",{className:"text-sm text-gray-900 mt-1",children:b(x.created_at)})]}),x.service&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Сервис"}),(0,a.jsx)("p",{className:"text-sm text-gray-900 mt-1",children:x.service})]}),x.component&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Компонент"}),(0,a.jsx)("p",{className:"text-sm text-gray-900 mt-1",children:x.component})]}),x.action&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Действие"}),(0,a.jsx)("p",{className:"text-sm text-gray-900 mt-1",children:x.action})]}),x.email&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Пользователь"}),(0,a.jsxs)("p",{className:"text-sm text-gray-900 mt-1",children:[x.email," (",x.first_name," ",x.last_name,")"]})]}),x.ip_address&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"IP адрес"}),(0,a.jsx)("p",{className:"text-sm text-gray-900 mt-1 font-mono",children:x.ip_address})]}),x.request_id&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"ID запроса"}),(0,a.jsx)("p",{className:"text-sm text-gray-900 mt-1 font-mono",children:x.request_id})]}),x.metadata&&Object.keys(x.metadata).length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Метаданные"}),(0,a.jsx)("pre",{className:"text-xs text-gray-900 mt-1 bg-gray-100 p-2 rounded overflow-x-auto",children:JSON.stringify(x.metadata,null,2)})]})]})]}):(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 text-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Выберите лог для просмотра деталей"})})})]})]})}function u(){let[e,t]=(0,r.useState)({}),[s,l]=(0,r.useState)(!0),[i,d]=(0,r.useState)(!1),[c,m]=(0,r.useState)({});(0,r.useEffect)(()=>{u()},[]);let u=async()=>{try{l(!0);let e=await n.h.get("/admin/settings");t(e.data),m(e.data)}catch(t){var e,s;o.default.error((null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.error)||"Ошибка загрузки настроек")}finally{l(!1)}},x=(e,t)=>{m(s=>({...s,[e]:{...s[e],value:t}}))},h=async()=>{try{d(!0);let s={};if(Object.entries(c).forEach(t=>{var a;let[r,l]=t;JSON.stringify(l.value)!==JSON.stringify(null===(a=e[r])||void 0===a?void 0:a.value)&&(s[r]={value:l.value})}),0===Object.keys(s).length){o.default.success("Настройки не изменились");return}await n.h.put("/admin/settings",{settings:s}),t(c),o.default.success("Настройки успешно сохранены")}catch(e){var s,a;o.default.error((null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.error)||"Ошибка сохранения настроек")}finally{d(!1)}},g=()=>JSON.stringify(c)!==JSON.stringify(e),p=(e,t)=>{let s=t.value,r=typeof s;return"boolean"===r?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:s,onChange:t=>x(e,t.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:s?"Включено":"Отключено"})]}):"number"===r?(0,a.jsx)("input",{type:"number",value:s,onChange:t=>x(e,parseFloat(t.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}):"object"===r&&null!==s?(0,a.jsx)("textarea",{value:JSON.stringify(s,null,2),onChange:t=>{try{let s=JSON.parse(t.target.value);x(e,s)}catch(e){}},rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm"}):(0,a.jsx)("input",{type:"text",value:s||"",onChange:t=>x(e,t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})};return s?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,a.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"h-20 bg-gray-200 rounded"},t))})]})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Настройки системы"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Конфигурация параметров системы"})]}),(0,a.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:h,disabled:i||!g(),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Сохранение...":"Сохранить изменения"}),(0,a.jsx)("button",{onClick:()=>{m(e)},disabled:!g(),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Сбросить"})]}),g()&&(0,a.jsx)("div",{className:"text-sm text-orange-600 font-medium",children:"Есть несохраненные изменения"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[Object.entries(c).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}),s.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600",children:s.description})]}),(0,a.jsx)("div",{className:"max-w-2xl",children:p(t,s)})]},t)}),0===Object.keys(c).length&&(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsxs)("div",{className:"text-gray-500",children:[(0,a.jsxs)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Нет настроек"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Настройки системы не найдены или не загружены."})]})})]})]})}function x(){let{user:e,updateProfile:t}=(0,l.useAuth)(),[s,i]=(0,r.useState)(!1),[n,d]=(0,r.useState)(!1),[c,m]=(0,r.useState)({firstName:"",lastName:"",email:"",phone:""});(0,r.useEffect)(()=>{e&&m({firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||"",phone:e.phone||""})},[e]);let u=(e,t)=>{m(s=>({...s,[e]:t}))},x=()=>c.firstName.trim()?c.lastName.trim()?c.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c.email)?!c.phone.trim()||!!/^[\+]?[1-9][\d]{0,15}$/.test(c.phone.trim())||(o.default.error("Неверный формат телефона"),!1):(o.default.error("Неверный формат email"),!1):(o.default.error("Email обязателен для заполнения"),!1):(o.default.error("Фамилия обязательна для заполнения"),!1):(o.default.error("Имя обязательно для заполнения"),!1),h=async()=>{if(x()){d(!0);try{let e={firstName:c.firstName.trim(),lastName:c.lastName.trim(),email:c.email.trim(),...c.phone.trim()&&{phone:c.phone.trim()}};await t(e),o.default.success("Профиль успешно обновлен")}catch(e){o.default.error(e.message||"Ошибка обновления профиля")}finally{d(!1)}}},g=()=>!!e&&(c.firstName.trim()!==(e.firstName||"")||c.lastName.trim()!==(e.lastName||"")||c.email.trim()!==(e.email||"")||c.phone.trim()!==(e.phone||""));return s?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,a.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"h-16 bg-gray-200 rounded"},t))})]})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Настройки профиля"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Управление личными данными администратора"})]}),(0,a.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:h,disabled:n||!g(),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Сохранение...":"Сохранить изменения"}),(0,a.jsx)("button",{onClick:()=>{e&&m({firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||"",phone:e.phone||""})},disabled:!g(),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Сбросить"})]}),g()&&(0,a.jsx)("div",{className:"text-sm text-orange-600 font-medium",children:"Есть несохраненные изменения"})]}),(0,a.jsxs)("div",{className:"max-w-2xl space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Личная информация"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Имя *"}),(0,a.jsx)("input",{type:"text",value:c.firstName,onChange:e=>u("firstName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Введите имя"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Фамилия *"}),(0,a.jsx)("input",{type:"text",value:c.lastName,onChange:e=>u("lastName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Введите фамилию"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Контактная информация"}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),(0,a.jsx)("input",{type:"email",value:c.email,onChange:e=>u("email",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Введите email"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Email используется для входа в систему"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Телефон"}),(0,a.jsx)("input",{type:"tel",value:c.phone,onChange:e=>u("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"+7 (999) 123-45-67"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Необязательное поле"})]})]})]}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"Важная информация"}),(0,a.jsx)("div",{className:"mt-2 text-sm text-blue-700",children:(0,a.jsxs)("ul",{className:"list-disc pl-5 space-y-1",children:[(0,a.jsx)("li",{children:"Изменение email потребует повторной авторизации"}),(0,a.jsx)("li",{children:"Все поля, отмеченные *, обязательны для заполнения"}),(0,a.jsx)("li",{children:"Телефон используется для уведомлений и восстановления доступа"})]})})]})]})})]})]})}function h(){let{user:e,loading:t,logout:s}=(0,l.useAuth)(),n=(0,i.useRouter)(),[o,h]=(0,r.useState)("dashboard");return((0,r.useEffect)(()=>{t||e&&"admin"===e.role||n.push("/login")},[e,t,n]),t)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):e&&"admin"===e.role?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Панель администратора"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Управление системой и пользователями"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Добро пожаловать, ",e.firstName," ",e.lastName]}),(0,a.jsx)("button",{onClick:()=>n.push("/"),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"На главную"}),(0,a.jsx)("button",{onClick:s,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700",children:"Выход"})]})]})})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,a.jsx)("div",{className:"lg:w-64",children:(0,a.jsx)("nav",{className:"space-y-2",children:[{id:"dashboard",name:"Панель управления",icon:"\uD83D\uDCCA"},{id:"users",name:"Пользователи",icon:"\uD83D\uDC65"},{id:"logs",name:"Логи",icon:"\uD83D\uDCCB"},{id:"settings",name:"Настройки системы",icon:"⚙️"},{id:"profile",name:"Мой профиль",icon:"\uD83D\uDC64"}].map(e=>(0,a.jsxs)("button",{onClick:()=>h(e.id),className:"w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ".concat(o===e.id?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"),children:[(0,a.jsx)("span",{className:"mr-3 text-lg",children:e.icon}),e.name]},e.id))})}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border",children:(()=>{switch(o){case"dashboard":default:return(0,a.jsx)(d,{});case"users":return(0,a.jsx)(c,{});case"logs":return(0,a.jsx)(m,{});case"settings":return(0,a.jsx)(u,{});case"profile":return(0,a.jsx)(x,{})}})()})})]})})]}):null}},826:function(e,t,s){"use strict";s.d(t,{h:function(){return a}});let a=s(4829).Z.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});a.interceptors.response.use(e=>e,e=>{var t,s;return((null===(t=e.response)||void 0===t?void 0:t.status)===401||(null===(s=e.response)||void 0===s?void 0:s.status)===403)&&(localStorage.removeItem("token"),delete a.defaults.headers.common.Authorization,window.location.href="/login"),Promise.reject(e)}),a.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e))},9438:function(e,t,s){"use strict";s.r(t),s.d(t,{AuthProvider:function(){return o},useAuth:function(){return c}});var a=s(7437),r=s(2265),l=s(826);class i{async sendLog(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isEnabled)try{await l.h.post("/admin/logs/client",{level:e,message:t,component:s.component,action:s.action,url:s.url||window.location.href,metadata:s.metadata})}catch(e){console.warn("Failed to send client log:",e)}}error(e,t){console.error("[CLIENT ERROR] ".concat(e),t),this.sendLog("error",e,t)}warn(e,t){console.warn("[CLIENT WARN] ".concat(e),t),this.sendLog("warn",e,t)}info(e,t){console.info("[CLIENT INFO] ".concat(e),t),this.sendLog("info",e,t)}debug(e,t){console.debug("[CLIENT DEBUG] ".concat(e),t),this.sendLog("debug",e,t)}userAction(e,t,s){this.info("User action: ".concat(e),{component:t,action:e,metadata:s})}apiError(e,t,s){var a;this.error("API Error: ".concat(e),{component:"API",action:"request",metadata:{endpoint:e,error:(null==t?void 0:t.message)||t,status:null==t?void 0:null===(a=t.response)||void 0===a?void 0:a.status,...s}})}navigation(e,t){this.info("Navigation: ".concat(e," -> ").concat(t),{component:"Router",action:"navigation",metadata:{from:e,to:t}})}componentError(e,t,s){this.error("Component Error: ".concat(e),{component:e,action:"render",metadata:{error:(null==t?void 0:t.message)||t,stack:null==t?void 0:t.stack,...s}})}constructor(){this.isEnabled=!0,this.isEnabled=!1}}let n=new i,d=(0,r.createContext)(void 0);function o(e){let{children:t}=e,[s,i]=(0,r.useState)(null),[o,c]=(0,r.useState)(!0);(0,r.useEffect)(()=>{m()},[]);let m=async()=>{try{let e=localStorage.getItem("token");if(!e){c(!1);return}l.h.defaults.headers.common.Authorization="Bearer ".concat(e);let t=await l.h.get("/auth/profile");i(t.data)}catch(e){console.error("Auth check failed:",e),localStorage.removeItem("token"),delete l.h.defaults.headers.common.Authorization}finally{c(!1)}},u=async(e,t)=>{try{n.info("Login attempt",{component:"Auth",action:"login",metadata:{email:e}});let{user:s,token:a,requiresTwoFactor:r,userId:d,requiresPasswordChange:o}=(await l.h.post("/auth/login",{email:e,password:t})).data;if(r)return{requiresTwoFactor:!0,userId:d};if(o)return{requiresPasswordChange:!0,userId:d};return localStorage.setItem("token",a),l.h.defaults.headers.common.Authorization="Bearer ".concat(a),i(s),n.info("Login successful",{component:"Auth",action:"login",metadata:{userId:s.id,email:e}}),{}}catch(i){var s,a,r;let t=null==i?void 0:null===(s=i.response)||void 0===s?void 0:s.status,l=null==i?void 0:null===(r=i.response)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.error;throw n.apiError("/auth/login",i,{email:e}),Error(401===t?"Неверный email или пароль":500===t?"Ошибка сервера при входе":l||"Ошибка входа")}},x=async e=>{try{let{userId:t,email:s}=(await l.h.post("/auth/register",e)).data;return{userId:t,email:s}}catch(l){var t,s,a;let e=null==l?void 0:null===(t=l.response)||void 0===t?void 0:t.status,r=null==l?void 0:null===(a=l.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.error;throw Error(409===e?"Пользователь с таким email уже существует":r||"Ошибка регистрации")}},h=async e=>{try{let t=await l.h.put("/auth/profile",e);i(e=>e?{...e,...t.data}:null)}catch(e){var t,s;throw Error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Ошибка обновления профиля")}},g=async(e,t)=>{try{let{token:s,user:a}=(await l.h.post("/auth/verify-2fa",{userId:e,code:t})).data;return localStorage.setItem("token",s),l.h.defaults.headers.common.Authorization="Bearer ".concat(s),i(a),s}catch(e){var s,a;throw Error((null==e?void 0:null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.error)||"Ошибка подтверждения 2FA")}},p=async(e,t)=>{try{let{token:s,user:a}=(await l.h.post("/auth/verify-email",{userId:e,code:t})).data;return s&&(localStorage.setItem("token",s),l.h.defaults.headers.common.Authorization="Bearer ".concat(s),i(a)),s}catch(e){var s,a;throw Error((null==e?void 0:null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.error)||"Ошибка подтверждения email")}},b=async(e,t)=>{try{await l.h.post("/auth/resend-code",{userId:e,type:t})}catch(e){var s,a;throw Error((null==e?void 0:null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.error)||"Ошибка отправки кода")}},f=async e=>{try{return(await l.h.post("/auth/check-company",{inn:e})).data}catch(e){var t,s;throw Error((null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Ошибка проверки компании")}},v=async(e,t,s)=>{try{await l.h.put("/auth/force-change-password",{userId:e,currentPassword:t,newPassword:s})}catch(e){var a,r;throw Error((null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.error)||"Ошибка смены пароля")}};return(0,a.jsx)(d.Provider,{value:{user:s,loading:o,login:u,register:x,logout:()=>{n.info("User logout",{component:"Auth",action:"logout",metadata:{userId:null==s?void 0:s.id}}),localStorage.removeItem("token"),delete l.h.defaults.headers.common.Authorization,i(null),window.location.href="/login"},updateProfile:h,verifyTwoFactor:g,verifyEmail:p,resendCode:b,checkCompany:f,forceChangePassword:v},children:t})}function c(){let e=(0,r.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4033:function(e,t,s){e.exports=s(5313)},5925:function(e,t,s){"use strict";let a,r;s.r(t),s.d(t,{CheckmarkIcon:function(){return K},ErrorIcon:function(){return W},LoaderIcon:function(){return G},ToastBar:function(){return ed},ToastIcon:function(){return es},Toaster:function(){return eu},default:function(){return ex},resolveValue:function(){return k},toast:function(){return T},useToaster:function(){return M},useToasterStore:function(){return U}});var l,i=s(2265);let n={data:""},d=e=>{if("object"==typeof window){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||n},o=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,c=/\/\*[^]*?\*\/|  +/g,m=/\n+/g,u=(e,t)=>{let s="",a="",r="";for(let l in e){let i=e[l];"@"==l[0]?"i"==l[1]?s=l+" "+i+";":a+="f"==l[1]?u(i,l):l+"{"+u(i,"k"==l[1]?"":t)+"}":"object"==typeof i?a+=u(i,t?t.replace(/([^,])+/g,e=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)):l):null!=i&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=u.p?u.p(l,i):l+":"+i+";")}return s+(t&&r?t+"{"+r+"}":r)+a},x={},h=e=>{if("object"==typeof e){let t="";for(let s in e)t+=s+h(e[s]);return t}return e},g=(e,t,s,a,r)=>{var l;let i=h(e),n=x[i]||(x[i]=(e=>{let t=0,s=11;for(;t<e.length;)s=101*s+e.charCodeAt(t++)>>>0;return"go"+s})(i));if(!x[n]){let t=i!==e?e:(e=>{let t,s,a=[{}];for(;t=o.exec(e.replace(c,""));)t[4]?a.shift():t[3]?(s=t[3].replace(m," ").trim(),a.unshift(a[0][s]=a[0][s]||{})):a[0][t[1]]=t[2].replace(m," ").trim();return a[0]})(e);x[n]=u(r?{["@keyframes "+n]:t}:t,s?"":"."+n)}let d=s&&x.g?x.g:null;return s&&(x.g=x[n]),l=x[n],d?t.data=t.data.replace(d,l):-1===t.data.indexOf(l)&&(t.data=a?l+t.data:t.data+l),n},p=(e,t,s)=>e.reduce((e,a,r)=>{let l=t[r];if(l&&l.call){let e=l(s),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;l=t?"."+t:e&&"object"==typeof e?e.props?"":u(e,""):!1===e?"":e}return e+a+(null==l?"":l)},"");function b(e){let t=this||{},s=e.call?e(t.p):e;return g(s.unshift?s.raw?p(s,[].slice.call(arguments,1),t.p):s.reduce((e,s)=>Object.assign(e,s&&s.call?s(t.p):s),{}):s,d(t.target),t.g,t.o,t.k)}b.bind({g:1});let f,v,y,j=b.bind({k:1});function N(e,t){let s=this||{};return function(){let a=arguments;function r(l,i){let n=Object.assign({},l),d=n.className||r.className;s.p=Object.assign({theme:v&&v()},n),s.o=/ *go\d+/.test(d),n.className=b.apply(s,a)+(d?" "+d:""),t&&(n.ref=i);let o=e;return e[0]&&(o=n.as||e,delete n.as),y&&o[0]&&y(n),f(o,n)}return t?t(r):r}}var w=e=>"function"==typeof e,k=(e,t)=>w(e)?e(t):e,C=(a=0,()=>(++a).toString()),E=()=>{if(void 0===r&&"u">typeof window){let e=matchMedia("(prefers-reduced-motion: reduce)");r=!e||e.matches}return r},S="default",D=(e,t)=>{let{toastLimit:s}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,s)};case 1:return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case 2:let{toast:a}=t;return D(e,{type:e.toasts.find(e=>e.id===a.id)?1:0,toast:a});case 3:let{toastId:r}=t;return{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,dismissed:!0,visible:!1}:e)};case 4:return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let l=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(e=>({...e,pauseDuration:e.pauseDuration+l}))}}},_=[],I={toasts:[],pausedAt:void 0,settings:{toastLimit:20}},A={},O=(e,t=S)=>{A[t]=D(A[t]||I,e),_.forEach(([e,s])=>{e===t&&s(A[t])})},L=e=>Object.keys(A).forEach(t=>O(e,t)),z=e=>Object.keys(A).find(t=>A[t].toasts.some(t=>t.id===e)),P=(e=S)=>t=>{O(t,e)},R={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},U=(e={},t=S)=>{let[s,a]=(0,i.useState)(A[t]||I),r=(0,i.useRef)(A[t]);(0,i.useEffect)(()=>(r.current!==A[t]&&a(A[t]),_.push([t,a]),()=>{let e=_.findIndex(([e])=>e===t);e>-1&&_.splice(e,1)}),[t]);let l=s.toasts.map(t=>{var s,a,r;return{...e,...e[t.type],...t,removeDelay:t.removeDelay||(null==(s=e[t.type])?void 0:s.removeDelay)||(null==e?void 0:e.removeDelay),duration:t.duration||(null==(a=e[t.type])?void 0:a.duration)||(null==e?void 0:e.duration)||R[t.type],style:{...e.style,...null==(r=e[t.type])?void 0:r.style,...t.style}}});return{...s,toasts:l}},B=(e,t="blank",s)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...s,id:(null==s?void 0:s.id)||C()}),$=e=>(t,s)=>{let a=B(t,e,s);return P(a.toasterId||z(a.id))({type:2,toast:a}),a.id},T=(e,t)=>$("blank")(e,t);T.error=$("error"),T.success=$("success"),T.loading=$("loading"),T.custom=$("custom"),T.dismiss=(e,t)=>{let s={type:3,toastId:e};t?P(t)(s):L(s)},T.dismissAll=e=>T.dismiss(void 0,e),T.remove=(e,t)=>{let s={type:4,toastId:e};t?P(t)(s):L(s)},T.removeAll=e=>T.remove(void 0,e),T.promise=(e,t,s)=>{let a=T.loading(t.loading,{...s,...null==s?void 0:s.loading});return"function"==typeof e&&(e=e()),e.then(e=>{let r=t.success?k(t.success,e):void 0;return r?T.success(r,{id:a,...s,...null==s?void 0:s.success}):T.dismiss(a),e}).catch(e=>{let r=t.error?k(t.error,e):void 0;r?T.error(r,{id:a,...s,...null==s?void 0:s.error}):T.dismiss(a)}),e};var F=1e3,M=(e,t="default")=>{let{toasts:s,pausedAt:a}=U(e,t),r=(0,i.useRef)(new Map).current,l=(0,i.useCallback)((e,t=F)=>{if(r.has(e))return;let s=setTimeout(()=>{r.delete(e),n({type:4,toastId:e})},t);r.set(e,s)},[]);(0,i.useEffect)(()=>{if(a)return;let e=Date.now(),r=s.map(s=>{if(s.duration===1/0)return;let a=(s.duration||0)+s.pauseDuration-(e-s.createdAt);if(a<0){s.visible&&T.dismiss(s.id);return}return setTimeout(()=>T.dismiss(s.id,t),a)});return()=>{r.forEach(e=>e&&clearTimeout(e))}},[s,a,t]);let n=(0,i.useCallback)(P(t),[t]),d=(0,i.useCallback)(()=>{n({type:5,time:Date.now()})},[n]),o=(0,i.useCallback)((e,t)=>{n({type:1,toast:{id:e,height:t}})},[n]),c=(0,i.useCallback)(()=>{a&&n({type:6,time:Date.now()})},[a,n]),m=(0,i.useCallback)((e,t)=>{let{reverseOrder:a=!1,gutter:r=8,defaultPosition:l}=t||{},i=s.filter(t=>(t.position||l)===(e.position||l)&&t.height),n=i.findIndex(t=>t.id===e.id),d=i.filter((e,t)=>t<n&&e.visible).length;return i.filter(e=>e.visible).slice(...a?[d+1]:[0,d]).reduce((e,t)=>e+(t.height||0)+r,0)},[s]);return(0,i.useEffect)(()=>{s.forEach(e=>{if(e.dismissed)l(e.id,e.removeDelay);else{let t=r.get(e.id);t&&(clearTimeout(t),r.delete(e.id))}})},[s,l]),{toasts:s,handlers:{updateHeight:o,startPause:d,endPause:c,calculateOffset:m}}},q=j`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,J=j`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,H=j`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,W=N("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${q} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${J} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${H} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Z=j`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,G=N("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${Z} 1s linear infinite;
`,V=j`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Y=j`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,K=N("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${V} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Y} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Q=N("div")`
  position: absolute;
`,X=N("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,ee=j`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,et=N("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${ee} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,es=({toast:e})=>{let{icon:t,type:s,iconTheme:a}=e;return void 0!==t?"string"==typeof t?i.createElement(et,null,t):t:"blank"===s?null:i.createElement(X,null,i.createElement(G,{...a}),"loading"!==s&&i.createElement(Q,null,"error"===s?i.createElement(W,{...a}):i.createElement(K,{...a})))},ea=e=>`
0% {transform: translate3d(0,${-200*e}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,er=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${-150*e}%,-1px) scale(.6); opacity:0;}
`,el=N("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,ei=N("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,en=(e,t)=>{let s=e.includes("top")?1:-1,[a,r]=E()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[ea(s),er(s)];return{animation:t?`${j(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${j(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},ed=i.memo(({toast:e,position:t,style:s,children:a})=>{let r=e.height?en(e.position||t||"top-center",e.visible):{opacity:0},l=i.createElement(es,{toast:e}),n=i.createElement(ei,{...e.ariaProps},k(e.message,e));return i.createElement(el,{className:e.className,style:{...r,...s,...e.style}},"function"==typeof a?a({icon:l,message:n}):i.createElement(i.Fragment,null,l,n))});l=i.createElement,u.p=void 0,f=l,v=void 0,y=void 0;var eo=({id:e,className:t,style:s,onHeightUpdate:a,children:r})=>{let l=i.useCallback(t=>{if(t){let s=()=>{a(e,t.getBoundingClientRect().height)};s(),new MutationObserver(s).observe(t,{subtree:!0,childList:!0,characterData:!0})}},[e,a]);return i.createElement("div",{ref:l,className:t,style:s},r)},ec=(e,t)=>{let s=e.includes("top"),a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:E()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(s?1:-1)}px)`,...s?{top:0}:{bottom:0},...a}},em=b`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,eu=({reverseOrder:e,position:t="top-center",toastOptions:s,gutter:a,children:r,toasterId:l,containerStyle:n,containerClassName:d})=>{let{toasts:o,handlers:c}=M(s,l);return i.createElement("div",{"data-rht-toaster":l||"",style:{position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none",...n},className:d,onMouseEnter:c.startPause,onMouseLeave:c.endPause},o.map(s=>{let l=s.position||t,n=ec(l,c.calculateOffset(s,{reverseOrder:e,gutter:a,defaultPosition:t}));return i.createElement(eo,{id:s.id,key:s.id,onHeightUpdate:c.updateHeight,className:s.visible?em:"",style:n},"custom"===s.type?k(s.message,s):r?r(s):i.createElement(ed,{toast:s,position:l}))}))},ex=T}},function(e){e.O(0,[737,971,938,744],function(){return e(e.s=8865)}),_N_E=e.O()}]);