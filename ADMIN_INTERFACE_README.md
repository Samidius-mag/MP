# Интерфейс администратора

## Обзор

Добавлен полнофункциональный интерфейс администратора с поддержкой:
- Просмотра и управления пользователями
- Мониторинга логов сервера и клиента
- Смены паролей пользователей
- Блокировки/разблокировки пользователей
- Настройки системы

## Установка и настройка

### 1. Установка зависимостей

```bash
# Сервер
cd server
npm install

# Клиент
cd client
npm install
```

### 2. Создание пользователя-администратора

```bash
cd server
npm run create-admin
```

По умолчанию создается администратор:
- Email: admin@dropshipping.com
- Пароль: Admin123!
- Имя: Администратор Системы
- Телефон: +7 (999) 123-45-67

Для изменения параметров установите переменные окружения:
```bash
export ADMIN_EMAIL="your-admin@email.com"
export ADMIN_PASSWORD="YourSecurePassword123!"
export ADMIN_FIRST_NAME="Ваше Имя"
export ADMIN_LAST_NAME="Ваша Фамилия"
export ADMIN_PHONE="+7 (999) 123-45-67"
```

### 3. Запуск системы

```bash
# Запуск сервера
cd server
npm start

# Запуск клиента
cd client
npm run dev
```

## Доступ к интерфейсу администратора

1. Откройте браузер и перейдите на `http://localhost:3000`
2. Войдите под учетной записью администратора
3. Перейдите на `/admin` для доступа к панели администратора

## Функциональность

### 1. Панель управления (Dashboard)
- Общая статистика системы
- Количество пользователей, клиентов, заказов
- Выручка
- Статистика по ролям и статусам
- Статистика логов за последние 24 часа

### 2. Управление пользователями
- Просмотр списка всех пользователей
- Поиск по email, имени или компании
- Фильтрация по ролям
- Просмотр детальной информации о пользователе
- Статистика пользователя (для клиентов)
- Блокировка/разблокировка пользователей
- Смена пароля пользователя

### 3. Просмотр логов
- Логи сервера и клиента
- Фильтрация по уровню, сервису, пользователю
- Фильтрация по дате
- Детальный просмотр логов
- Статистика логов

### 4. Настройки системы
- Просмотр и редактирование настроек
- Поддержка различных типов данных
- Валидация настроек

## API Endpoints

### Административные endpoints

#### Пользователи
- `GET /api/admin/users` - Список пользователей
- `GET /api/admin/users/:id` - Детали пользователя
- `PUT /api/admin/users/:id` - Обновление пользователя
- `PUT /api/admin/users/:id/password` - Смена пароля
- `PUT /api/admin/users/:id/status` - Блокировка/разблокировка

#### Логи
- `GET /api/admin/logs/server` - Логи сервера
- `GET /api/admin/logs/client` - Логи клиента
- `GET /api/admin/logs/stats` - Статистика логов
- `POST /api/admin/logs/client` - Логирование клиентских событий

#### Статистика
- `GET /api/admin/stats` - Общая статистика системы

#### Настройки
- `GET /api/admin/settings` - Получение настроек
- `PUT /api/admin/settings` - Обновление настроек

## Логирование

### Серверные логи
Автоматически логируются:
- HTTP запросы и ответы
- Ошибки приложения
- Действия пользователей
- Системные события

### Клиентские логи
Логируются через `clientLogger`:
- Действия пользователей
- Ошибки компонентов
- API ошибки
- Навигация

Пример использования:
```typescript
import { clientLogger } from '@/lib/clientLogger';

// Обычное логирование
clientLogger.info('User clicked button', { component: 'Button', action: 'click' });
clientLogger.error('API request failed', { component: 'API', action: 'request' });

// Специальные методы
clientLogger.userAction('login', 'AuthForm');
clientLogger.apiError('/api/users', error);
clientLogger.componentError('UserProfile', error);
```

## Безопасность

- Все административные endpoints требуют роль 'admin'
- Логирование всех действий администратора
- Валидация всех входных данных
- Хеширование паролей с bcrypt

## Мониторинг

### Логи сервера
- Уровни: error, warn, info, debug
- Сервисы: auth, orders, payment, admin, http
- Метаданные: IP, User-Agent, Request ID

### Логи клиента
- Уровни: error, warn, info, debug
- Компоненты: React компоненты
- Действия: пользовательские действия
- URL: текущая страница

## Устранение неполадок

### Проблемы с доступом
1. Убедитесь, что пользователь имеет роль 'admin'
2. Проверьте, что токен авторизации действителен
3. Проверьте логи сервера на наличие ошибок

### Проблемы с логами
1. Проверьте подключение к базе данных
2. Убедитесь, что таблицы логов созданы
3. Проверьте права доступа к таблицам

### Проблемы с производительностью
1. Настройте индексы для таблиц логов
2. Ограничьте количество записей в запросах
3. Используйте пагинацию для больших списков

## Развертывание

### Переменные окружения
```bash
# Обязательные
JWT_SECRET=your-jwt-secret
DB_HOST=localhost
DB_PORT=5432
DB_NAME=dropshipping_db
DB_USER=dropshipping
DB_PASSWORD=your-password

# Опциональные
ADMIN_EMAIL=admin@dropshipping.com
ADMIN_PASSWORD=Admin123!
ADMIN_FIRST_NAME=Администратор
ADMIN_LAST_NAME=Системы
ADMIN_PHONE=+7 (999) 123-45-67
```

### Docker
```bash
# Сборка и запуск
docker-compose up --build

# Создание администратора
docker-compose exec server npm run create-admin
```

## Поддержка

При возникновении проблем:
1. Проверьте логи сервера и клиента
2. Убедитесь в корректности настроек
3. Проверьте права доступа к базе данных
4. Обратитесь к документации API





