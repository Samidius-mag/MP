# Описание реализации TravelersGuild

## Что было реализовано

### 1. Система рангов

Реализована система из 5 рангов:
- **Ранг C** (Новичок) - зеленый цвет ника, требуется 10 убийств монстров
- **Ранг B** (Опытный) - синий цвет ника, требуется 100 убийств
- **Ранг A** (Мастер) - красный цвет ника, требуется 1000 убийств
- **Ранг S** (Герой) - золотой цвет ника, требуется 5000 убийств
- **Ранг SS** (Ультра Герой) - переливающийся цвет ника, требуется 10000+ убийств

### 2. NPC-заведующий гильдией

- Создается как житель (Villager) с профессией Картограф
- Бессмертен (invulnerable = true)
- Отключен AI (не двигается)
- При попытке атаки:
  - Игрок мгновенно умирает
  - Игрок получает бан на 5 минут
  - Отображается предупреждающее сообщение

### 3. Система цветов ников

- Используется система команд (Teams) в Minecraft
- Цвет ника автоматически меняется при изменении ранга
- Для ранга SS реализован переливающийся эффект

### 4. Бегущие строки

- При входе игрока с рангом S или SS показывается объявление всем игрокам
- Сообщение отображается в чате с форматированием

### 5. Салют и подарки для ранга SS

- При достижении ранга SS запускается салют из 20 фейерверков
- Все игроки онлайн получают 3 золотых яблока
- Отображается праздничное сообщение

### 6. Система отрядов

- Создание отряда (лидер)
- Вступление в существующий отряд
- Покидание отряда
- Роспуск отряда (для лидера)

### 7. Меню взаимодействия

Интуитивное меню с кнопками для:
- Регистрации в гильдии
- Просмотра информации о ранге
- Повышения ранга
- Управления отрядами

## Технические детали

### Хранение данных

Все данные хранятся в YAML файле `guild_data.yml`:
- Информация о зарегистрированных игроках
- Количество убийств монстров
- Ранги игроков
- Список отрядов и участников

### Отслеживание убийств

Плагин отслеживает убийства монстров через событие `EntityDeathEvent`.
Учитываются только убийства монстров (не животных и не игроков).

### Автоматическое повышение ранга

Ранг повышается автоматически при достижении необходимого количества убийств.
Также можно вручную повысить ранг через меню, если есть достаточно убийств.

## Структура классов

### Основные классы

1. **TravelersGuild** - главный класс плагина
2. **GuildDataManager** - управление данными игроков и отрядов
3. **Rank** - перечисление рангов с их свойствами
4. **GuildMasterNPC** - управление NPC-заведующим
5. **GuildMenu** - меню взаимодействия
6. **NameColorManager** - управление цветом ников
7. **AnnouncementManager** - объявления и эффекты

### События

Плагин обрабатывает следующие события:
- `PlayerJoinEvent` - обновление цвета ника и показ объявлений
- `PlayerQuitEvent` - сохранение данных
- `EntityDeathEvent` - отслеживание убийств монстров
- `EntityDamageEvent` - защита NPC от урона
- `PlayerInteractEntityEvent` - взаимодействие с NPC
- `InventoryClickEvent` - обработка кликов в меню
- `AsyncPlayerChatEvent` - ввод названий отрядов

## Интеграция с архитектурой гильдии

Плагин готов к использованию с построенной гильдией путешественников:

1. **Главный зал** - место для NPC-заведующего (используйте `/guildadmin spawn`)
2. **Библиотека-архив** - можно добавить книги с информацией о рангах
3. **Комната отдыха** - место для общения членов гильдии
4. **Склад снаряжения** - для хранения припасов
5. **Наблюдательная башня** - для обзора мира
6. **Внешний двор** - для собраний и мероприятий

## Будущие улучшения

Возможные дополнения:
- Система заданий/квестов
- Дополнительные награды за достижения
- Статистика гильдии
- Рейтинг игроков
- Специальные способности для высоких рангов
- Интеграция с экономикой сервера

